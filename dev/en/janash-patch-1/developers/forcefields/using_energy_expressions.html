<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using the Energy Expression &mdash; SEAMM 2022.8.23-1-gf43c14f documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PQXXTJ2');</script>
<!-- End Google Tag Manager -->

<!-- Get plotly for graphs -->
<script src="https://cdn.plot.ly/plotly-2.8.3.min.js"></script>


  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tips and Tricks" href="../tips-and-tricks/index.html" />
    <link rel="prev" title="Energy Expression" href="energy_expression.html" /> 
</head>

<body class="wy-body-for-nav">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PQXXTJ2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
 

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> SEAMM
          </a>
              <div class="version">
                2022.8.23-1-gf43c14f
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../why_seamm/index.html">Why SEAMM?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../why_seamm/user_experience.html">User Experience</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../why_seamm/productivity.html">Productivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../why_seamm/workflow_features.html">Workflow Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installing SEAMM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation/graphical.html">Graphical Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/command-line.html">Command Line Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_1.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/dashboard_management.html">Managing the Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_2.html">Working with the Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_3.html">Tables and Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_4.html">Running from the Command-Line</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developers Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../home_for_tools.html">A Home for Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software_ecosystem/index.html">Software Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software_ecosystem/gui.html">Graphical User Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software_ecosystem/dashboard.html">Dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software_ecosystem/flowchart.html">Flowchart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software_ecosystem/flowchart_interpreter.html">Flowchart Interpreter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software_ecosystem/job_manager.html">Job Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software_ecosystem/job_datastore.html">Job Datastore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plug-ins.html">Plug-ins</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Handling Forcefields and Interatomic Potentials in SEAMM</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plugin_anatomy.html">Anatomy of a Forcefield Plug-in</a></li>
<li class="toctree-l3"><a class="reference internal" href="selection.html">Selecting a Forcefield</a></li>
<li class="toctree-l3"><a class="reference internal" href="atom_typing.html">Atom Typing</a></li>
<li class="toctree-l3"><a class="reference internal" href="energy_expression.html">Energy Expression</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using the Energy Expression</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tips-and-tricks/index.html">Tips and Tricks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tips-and-tricks/update-with-cookiecutter.html">Updating with Cookiecutter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html">Tutorials for Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/development_environment.html">Installing the Development Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/simple_plugin/index.html">A simple plug-in: PySCF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/simple_plugin/cookiecutter.html">Creating the plug-in with the seamm-cookiecutter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/simple_plugin/compiling.html">“Compiling” the plug-in</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/simple_plugin/code_overview.html">An overview of the code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/simple_plugin/customizing.html">Customizing the plug-in to run PySCF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/simple_plugin/flowchart.html">Create a test flowchart</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../whitepapers/index.html">Whitepapers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../whitepapers/system.html">Systems: Molecules, Crystal, Fluids and all that</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../whitepapers/forcefields/overview.html">Overview of Forcefields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/forcefields/functional_form.html">Functional Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/forcefields/parameters.html">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/forcefields/atom_types.html">Atom Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/forcefields/types_of_forcefields.html">Types of Forcefields</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plug-ins/index.html">Plug-ins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/building.html">Building</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/crystal_builder_step/index.html">Crystal Builder</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/packmol_step/index.html">PACKMOL</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/set_cell_step/index.html">Set Cell</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/solvate_step/index.html">Solvate</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/supercell_step/index.html">Supercell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/control.html">Control</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/control_parameters_step/index.html">Control Parameters</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/loop_step/index.html">Loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/data.html">Data</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/read_structure_step/index.html">Read Structure</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/table_step/index.html">Table</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/system_step/index.html">System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/simulations.html">Simulations</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/dftbplus_step/index.html">DFTB+</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/lammps_step/index.html">LAMMPS</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/mopac_step/index.html">MOPAC</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/psi4_step/index.html">Psi4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../status/index.html">Status</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../status/building.html">Building plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/control.html">Control plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/custom.html">Custom plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/data.html">Data plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/simulations.html">Simulation plug-ins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics/index.html">Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/control-parameters-step.html">control-parameters-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/crystal-builder-step.html">crystal-builder-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/custom-step.html">custom-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/dftbplus-step.html">dftbplus-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/forcefield-step.html">forcefield-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/from-smiles-step.html">from-smiles-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/lammps-step.html">lammps-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/loop-step.html">loop-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/molsystem.html">molsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/mopac-step.html">mopac-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/packmol-step.html">packmol-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/psi4-step.html">psi4-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/pyxtal-step.html">pyxtal-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/rdkit-step.html">rdkit-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/read-structure-step.html">read-structure-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/reference-handler.html">reference-handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm.html">seamm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-datastore.html">seamm-datastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-ff-util.html">seamm-ff-util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-installer.html">seamm-installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-jobserver.html">seamm-jobserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-util.html">seamm-util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-widgets.html">seamm-widgets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/set-cell-step.html">set-cell-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/supercell-step.html">supercell-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/table-step.html">table-step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_team.html">SEAMM Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SEAMM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Developers Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Handling Forcefields and Interatomic Potentials in SEAMM</a></li>
      <li class="breadcrumb-item active">Using the Energy Expression</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developers/forcefields/using_energy_expressions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-the-energy-expression">
<h1>Using the Energy Expression<a class="headerlink" href="#using-the-energy-expression" title="Permalink to this heading"></a></h1>
<p>Now we turn our attention to the plug-in for the simulation code that wishes to use the
forcefield. There are two approaches to handling the previous steps of selecting and
setting up the forcefield and energy expression. The first approach is to keep it
separate from the simulation codes using the <cite>forcefield_step</cite> or a similar plug-in to
handle the forcefield setup. The advantage of this approach is that the forcefield setup
is global, so if a flowchart has several simulation steps using either the same code or
different ones, the user only has to setup the forcefield once and then all simulations
will use that setup. This approach reduces redundancy, inconsistencies, and errors.</p>
<p>The other approach is for the simulation plug-in to handle all the aspects of the
forcefield setup and use. This is clearly the preferred approach where the forcefield
is hidden from the user and captive to the simulation or only one forcefield is
usable. Examples where this would be a good approach might be</p>
<ul class="simple">
<li><p>for cleaning up poor structures, which might use a variety of algorithms and
specialized to more general forcefields to progressively clean the structure.</p></li>
<li><p>for a plug-in specialized to a certain property or class of structures where the
results are tuned for a specific forcefield or group of forcefileds and the user has
limited choice and control by design.</p></li>
<li><p>for initial implementations of simulation engines using their native tools and files,
though hopefully over time the implementation will be generalized to allow the users
to use other forcefields with the engine, any forcefields sepcific to that engine with
other codes.</p></li>
</ul>
<p>If a plug-in is using forcefields provided by plug-ins in either of the two scenarios
then the plug-in first needs to verify that it can handle the requested forcefield, and
if so it needs to translate the generic SEAMM energy expression to the form needed.</p>
<p>Checking that the requested forcefiled can be handled is straightforward. The energy
expression provides metadata about the terms and their functional forms in the energy
expression. The plug-in needs to check that it can handle all of the terms and
functional forms. If not it needs to throw an appropriate error.</p>
<p>Once it is determined that the energy expression can be handled, the next step is to
translate the energy expression provide by SEAMM into the form the simulation code
uses. This is of course specific to the code being used, but in general it involves
creating an input file (e.g. LAMMPS) or a topology file (e.g. AMBER and GROMACS). This
is the main task of the plug-in, along with gethering and setting up the control
parameters for the simulation, e.g. the temperature, pressure, stepsize, length of
simulation, etc.</p>
<p>Once the simulation is setup the plug-in is responsible for running the calculation,
usually using the standard SEAMM framework, and then processing and analyzing the
results of the simulation, as needed.</p>
<p>The SEAMM cookiecutter will provide initial versions of the files need to the plug-in,
along with much of the code for e.g. running the calculation. You task as a developer
will be to tweak some of the details, such as the executables to run, and fill out the
code with the specific translation and analysis needed for the simulation.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="energy_expression.html" class="btn btn-neutral float-left" title="Energy Expression" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tips-and-tricks/index.html" class="btn btn-neutral float-right" title="Tips and Tricks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<p>
<div class="row">
  <div class="column_left">
    <a href="https://molssi.org/" target="_blank" title="Go to MolSSI in a new tab">
      <img src="/_images/MolSSI.jpg" alt="The MolSSI" style="border:0;">
    </a>
  </div>
  <div class="column">
    &copy; Copyright 2019-2022, the Molecular Sciences Software Institute,
    which receives funding from the National Science Foundation under awards OAC-1547580
    and CHE-2136142.
  </div>
  <div class="column_right">
    <a href="https://nsf.gov/" target="_blank" title="Go to the NSF in a new tab">
      <img src="/_images/NSF_4-Color_bitmap_Logo.png" alt="The NSF" style="border:0;">
    </a>
  </div>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>