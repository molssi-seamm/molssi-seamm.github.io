<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Functional Form &mdash; SEAMM 2022.11.7 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PQXXTJ2');</script>
<!-- End Google Tag Manager -->

<!-- Get plotly for graphs -->
<script src="https://cdn.plot.ly/plotly-2.8.3.min.js"></script>


  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parameters" href="parameters.html" />
    <link rel="prev" title="Overview of Forcefields" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PQXXTJ2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
 

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> SEAMM
          </a>
              <div class="version">
                2022.11.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../why_seamm/index.html">Why SEAMM?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../why_seamm/user_experience.html">User Experience</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../why_seamm/productivity.html">Productivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../why_seamm/workflow_features.html">Workflow Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installing SEAMM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation/graphical.html">Graphical Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/command-line.html">Command Line Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_1.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/dashboard_management.html">Managing the Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_2.html">Working with the Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_3.html">Tables and Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tutorial_4.html">Running from the Command-Line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/index.html">Developers Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developers/home_for_tools.html">A Home for Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/software_ecosystem/index.html">Software Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developers/software_ecosystem/gui.html">Graphical User Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/software_ecosystem/dashboard.html">Dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/software_ecosystem/flowchart.html">Flowchart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/software_ecosystem/flowchart_interpreter.html">Flowchart Interpreter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/software_ecosystem/job_manager.html">Job Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/software_ecosystem/job_datastore.html">Job Datastore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/plug-ins.html">Plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/forcefields/index.html">Handling Forcefields and Interatomic Potentials in SEAMM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developers/forcefields/plugin_anatomy.html">Anatomy of a Forcefield Plug-in</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/forcefields/selection.html">Selecting a Forcefield</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/forcefields/atom_typing.html">Atom Typing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/forcefields/energy_expression.html">Energy Expression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/forcefields/using_energy_expressions.html">Using the Energy Expression</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/new-plug-in/index.html">Creating a New Plug-in</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developers/new-plug-in/properties.html">Saving Properties in the Database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/tips-and-tricks/index.html">Tips and Tricks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developers/tips-and-tricks/update-with-cookiecutter.html">Updating with Cookiecutter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/tutorials/index.html">Tutorials for Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developers/tutorials/development_environment.html">Installing the Development Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developers/tutorials/simple_plugin/index.html">A simple plug-in: PySCF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../developers/tutorials/simple_plugin/cookiecutter.html">Creating the plug-in with the seamm-cookiecutter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developers/tutorials/simple_plugin/compiling.html">“Compiling” the plug-in</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developers/tutorials/simple_plugin/code_overview.html">An overview of the code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developers/tutorials/simple_plugin/customizing.html">Customizing the plug-in to run PySCF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developers/tutorials/simple_plugin/flowchart.html">Create a test flowchart</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developers/core_modules.html">Core Modules</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/seamm/index.html"> seamm</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/molsystem/index.html"> molsystem</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/seamm_util/index.html"> seamm-util</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/seamm_widgets/index.html"> seamm-widgets</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/seamm_ff_util/index.html"> seamm-ff-util</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/seamm_jobserver/index.html"> seamm-jobserver</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/seamm_installer/index.html"> seamm-installer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Whitepapers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../system.html">Systems: Molecules, Crystal, Fluids and all that</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="overview.html">Overview of Forcefields</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Functional Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="atom_types.html">Atom Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="types_of_forcefields.html">Types of Forcefields</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plug-ins/index.html">Plug-ins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/building.html">Building</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/crystal_builder_step/index.html">Crystal Builder</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/from_smiles_step/index.html">From SMILES</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/packmol_step/index.html">PACKMOL</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/set_cell_step/index.html">Set Cell</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/strain_step/index.html">Strain</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/supercell_step/index.html">Supercell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/control.html">Control</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/control_parameters_step/index.html">Control Parameters</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/loop_step/index.html">Loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/data.html">Data</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/read_structure_step/index.html">Read Structure</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/table_step/index.html">Table</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/system_step/index.html">System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../plug-ins/simulations.html">Simulations</a><ul>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/dftbplus_step/index.html">DFTB+</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/lammps_step/index.html">LAMMPS</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/mopac_step/index.html">MOPAC</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/psi4_step/index.html">Psi4</a></li>
<li class="toctree-l3"><a class="reference external" href="https://molssi-seamm.github.io/quickmin_step/index.html">QuickMin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../status/index.html">Status</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../status/building.html">Building plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/control.html">Control plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/custom.html">Custom plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/data.html">Data plug-ins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../status/simulations.html">Simulation plug-ins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics/index.html">Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/control-parameters-step.html">control-parameters-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/crystal-builder-step.html">crystal-builder-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/custom-step.html">custom-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/dftbplus-step.html">dftbplus-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/forcefield-step.html">forcefield-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/from-smiles-step.html">from-smiles-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/lammps-step.html">lammps-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/loop-step.html">loop-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/molsystem.html">molsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/mopac-step.html">mopac-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/packmol-step.html">packmol-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/psi4-step.html">psi4-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/pyxtal-step.html">pyxtal-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/rdkit-step.html">rdkit-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/read-structure-step.html">read-structure-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/reference-handler.html">reference-handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm.html">seamm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-dashboard.html">seamm-dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-datastore.html">seamm-datastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-ff-util.html">seamm-ff-util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-installer.html">seamm-installer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-jobserver.html">seamm-jobserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-util.html">seamm-util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/seamm-widgets.html">seamm-widgets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/set-cell-step.html">set-cell-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/supercell-step.html">supercell-step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/table-step.html">table-step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_team.html">SEAMM Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SEAMM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Whitepapers</a></li>
          <li class="breadcrumb-item"><a href="overview.html">Overview of Forcefields</a></li>
      <li class="breadcrumb-item active">Functional Form</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/whitepapers/forcefields/functional_form.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="functional-form">
<h1>Functional Form<a class="headerlink" href="#functional-form" title="Permalink to this heading"></a></h1>
<p>What is the form of the mathematical equations that describe the OPLS forcefield? Let’s
wade through the <cite>paper &lt;https://pubs.acs.org/doi/10.1021/ja00334a030&gt;</cite> and see!  The
first relevant part of the description of the forcefield is this:</p>
<figure class="align-center" id="id1">
<img alt="van der Waals interactions in OPLS" src="../../_images/OPLS-1.png" />
<figcaption>
<p><span class="caption-text">Figure 1: The van der Waals interactions in OPLS</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>This section is defining the nonbonded interactions between atoms of different molecules,
representing the <a class="reference external" href="https://en.wikipedia.org/wiki/Van_der_Waals_force">van der Waals</a>
interactions between the molecules. There are four main contributions to the interaction
between molecules:</p>
<ol class="arabic simple">
<li><p>The short range repulsion between atoms due to the Pauli repulsion principle;</p></li>
<li><p>The Coulombic interaction between the permanent charges, dipole, quadrupole
and higher multipole moments of the molecules;</p></li>
<li><p>The Coulombic interaction between the multipoles induced on each molecule by the
other molecules, which is often referred to as the polarization of the molecule;</p></li>
<li><p>The London dispersion forces due to the interaction of the instantaneous fluctuations
of the charge distribution on the pair of molecules.</p></li>
</ol>
<p>The first term in the OPLS equation above represents the second contribution, the
Coulombic interaction between permanent charges and multipoles. The second and third
terms in the equation are those of the <a class="reference external" href="https://en.wikipedia.org/wiki/Lennard-Jones_potential">Lennard-Jones potential</a>, which represent the second and
fourth contributions, the repulsive and London forces. OPLS ignores the polarization
contribution, the third contribution listed above.</p>
<p>The text after the equation states that the Lennard-Jones parameters, which in general
are a function of the two atoms interacting, are approximated using <a class="reference external" href="https://en.wikipedia.org/wiki/Combining_rules">combining rules</a> and parameters depending on just one
center rather than two. The equations given are called the “geometric combining rules”,
which, inexplicably, are not mentioned in the Wikipedia article referenced.</p>
<p>The next section of the paper clarifies some details:</p>
<figure class="align-center" id="id2">
<img alt="United atom description in OPLS" src="../../_images/OPLS-2.png" />
<figcaption>
<p><span class="caption-text">Figure 2: More detail about the van der Waals interactions</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Here we learn three things:</p>
<ol class="arabic simple">
<li><p>Hydrogen atoms are ignored in the OPLS forcefield. The van der Waals
interactions are between the locations of the carbon atoms. This is usually referred
to as the united atom approximation.</p></li>
<li><p>They slip in a bit about the bonds and angles, which are assumed to be fixed lengths
and angles, as given in Table I. The torsions around bonds, however, are allowed to
change, but we will get to that in a moment.</p></li>
<li><p>Finally, in OPLS it is assumed that the <span class="math notranslate nohighlight">\(\mathrm{CH}_{n}\)</span> groups are electrically
neutral so there are no charges or multipoles on the molecules. This is an
approximation, but they argue a reasonable one.</p></li>
</ol>
<p>Putting all of this together, we can rewrite their Equation 1 as</p>
<div class="math notranslate nohighlight" id="equation-epsab">
<span class="eqno">(1)<a class="headerlink" href="#equation-epsab" title="Permalink to this equation"></a></span>\[\epsilon_{ab} = \sum_{i}^{on\,a} \sum_{j}^{on\,b} \frac{A_{ij}}{r_{ij}^{12}} - \frac{B_{ij}}{r_{ij}^{6}}\]</div>
<p>On to the torsion terms:</p>
<figure class="align-center" id="id3">
<img alt="Torsion (dihedral) description in OPLS" src="../../_images/OPLS-3.png" />
<figcaption>
<p><span class="caption-text">Figure 3: The torsions in OPLS</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>This snippet refers to the “internal rotations” of the molecule, though elsewhere they
call them the “torsional motions”. This term, which is sometimes called the “dihedral”
term, accounts for the rotational barrier around bonds, typically single bonds. Their
Equation 2 is a Fourier expansion in terms of multiples of the torsional angle
<span class="math notranslate nohighlight">\(phi\)</span>, truncated after the <span class="math notranslate nohighlight">\(4^{th}\)</span> term. They note that this is used
for the smaller linear and branched alkanes. A bit further in the paper is a discussion
about the longer normal hydrocarbons n-pentane and n-hexane where they introduce an
extended form of the equation:</p>
<figure class="align-center" id="id4">
<img alt="Torsion description in OPLS for n-pentane and n-hexane" src="../../_images/OPLS-4.png" />
<figcaption>
<p><span class="caption-text">Figure 4: The torsions in OPLS for n-pentane and n-hexane</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Their Equation 3 is written in a perhaps confusing way. It is a combination of their Equation 2,
unchanged, for the torsions in these larger molecules, and a variation of
Equation <a class="reference internal" href="#equation-epsab">(1)</a> for the van der Waals interactions but for <strong>intra</strong>molecular interactions
rather than the <strong>inter</strong>molecular. There is no obvious connection between the these two
terms – indeed they involve different atoms – so it is preferable to think of
Equation <a class="reference internal" href="#equation-etorsion">(2)</a> handling all of the torsions in the molecules, and Equation <a class="reference internal" href="#equation-epsab">(1)</a> for
handling all the van der Waals interactions, with the restriction that all
intramolecular interactions of atoms separated by 3 or fewer bonds, i.e. 1,4 or less to
each other, are ignored. Note that all the atoms in the first alkanes they mentioned,
n-butane, isopentane, and 1-butene, have no carbon atoms more than two bonds apart, so
the summation in their Equation 3 will have no terms, and hence for those molecules
their Equation 3 is equivalent to Equation <a class="reference internal" href="#equation-etorsion">(2)</a>. Thus the equation for the torsional
energy is</p>
<div class="math notranslate nohighlight" id="equation-etorsion">
<span class="eqno">(2)<a class="headerlink" href="#equation-etorsion" title="Permalink to this equation"></a></span>\[V(\phi) = V_0 + \frac{1}{2}V_1(1+\cos\phi) + \frac{1}{2}V_2(1-\cos2\phi) + \frac{1}{2}V_3(1+\cos3\phi)\]</div>
<p>This completes the description of the functional form of the OPLS forcefield as
described in this paper. The functional form is as follows:</p>
<ol class="arabic simple">
<li><p>Equation <a class="reference internal" href="#equation-epsab">(1)</a> covers both inter- and intra-molecular van der Waals (nonbonded)
interactions with the stipulation that the two atoms are separated by more than 3
bonds, i.e. are 1,5 or greater from each other. The hydrogen atoms are ignored, so
only the carbon atoms count, and their coordinates are used for the distances in the
equation.</p></li>
<li><p>The bond lengths are fixed at given lengths, as are the bond angles.</p></li>
<li><p>The torsions are handled by Equation <a class="reference internal" href="#equation-etorsion">(2)</a>.</p></li>
</ol>
<p>Putting all of this together we can write the total energy of the system as a function
of the coordinates of the atoms <span class="math notranslate nohighlight">\(\vec{r_i}\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-e">
<span class="eqno">(3)<a class="headerlink" href="#equation-e" title="Permalink to this equation"></a></span>\[\begin{split}E &amp;= F(\vec{r_i})\\
&amp;= \sum_{i} \sum_{j}^{j&gt;i\,and\,&gt;1,4} \frac{A_{ij}}{r_{ij}^{12}} -
\frac{B_{ij}}{r_{ij}^{6}} + \sum_{t}^{torsions} V_{t,0} +
\frac{1}{2}V_{t,1}(1+\cos\phi_t) + \frac{1}{2}V_{t,2}(1-\cos2\phi_t) +
\frac{1}{2}V_{t,3}(1+\cos3\phi_t)\end{split}\]</div>
<p>where the sum over the atoms in the first term, the van der Waals interaction, runs over
the unique pairs of atoms which are either in different molecules or separated by more
than three bonds if the atoms are in the same molecule. The condition <span class="math notranslate nohighlight">\(j&gt;i\)</span> avoids
double counting the interactions. Remembering the condition that bond lengths and angles
are fixed at specified values, this is the functional form of the OPLS forcefield.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview of Forcefields" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parameters.html" class="btn btn-neutral float-right" title="Parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  

<p>
<div class="row">
  <div class="column_left">
    <a href="https://molssi.org/" target="_blank" title="Go to MolSSI in a new tab">
      <img src="/_images/MolSSI.jpg" alt="The MolSSI" style="border:0;">
    </a>
  </div>
  <div class="column">
    &copy; Copyright 2019-2022, the Molecular Sciences Software Institute,
    which receives funding from the National Science Foundation under awards OAC-1547580
    and CHE-2136142.
  </div>
  <div class="column_right">
    <a href="https://nsf.gov/" target="_blank" title="Go to the NSF in a new tab">
      <img src="/_images/NSF_4-Color_bitmap_Logo.png" alt="The NSF" style="border:0;">
    </a>
  </div>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>